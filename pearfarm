#!/usr/bin/env php
<?php

if (strpos('@php_bin@', '@php_bin') === 0)  // not a pear install
{
    require_once dirname(__FILE__).DIRECTORY_SEPARATOR.'pearfarm.php';
}
else
{
    require 'pearfarm'.DIRECTORY_SEPARATOR.'pearfarm.php';
}

if (isset($argv[1]))
{
    $specfile = $argv[1];
}
else
{
    $specfile = getcwd() . '/pearfarm.spec';
}

print "Reading specfile at {$specfile}...\n";
if (!file_exists($specfile))
{
    print "{$specfile} is not a pearfarm.spec file.\n";
    exit(1);
}

include $specfile;
if (!isset($spec))
{
    print "specfile didn't create a local variable named '\$spec'.\n";
    exit(1);
}

$spec->writePackageFile();

print "The package.xml file was written successfully.\n";